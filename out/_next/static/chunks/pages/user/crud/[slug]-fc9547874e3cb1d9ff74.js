_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[31],{"0iGR":function(e,t,n){"use strict";n.r(t);var r=n("q1tI"),a=n.n(r),c=n("5Yp1"),l=n("yxxe"),o=n("AhMt"),s=(n("YFqc"),a.a.createElement);t.default=function(){return s(c.a,null,s(l.a,null,s("div",{className:"container-fluid"},s("div",{className:"row"},s("div",{className:"col-md-12 pt-5 pb-5"},s("h2",null,"Update blog")),s("div",{className:"col-md-12"},s(o.a,null))))))}},AhMt:function(e,t,n){"use strict";var r=n("KQm4"),a=n("rePB"),c=n("q1tI"),l=n.n(c),o=(n("YFqc"),n("nOHt")),s=n.n(o),u=n("a6RD"),i=n.n(u),m=n("iuBY"),f=n("abxw"),b=n("SMr6"),d=n("zycw"),p=(n("91UR"),n("//g3")),O=n("obyI"),h=l.a.createElement;function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){Object(a.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y=i()((function(){return Promise.all([n.e(0),n.e(8),n.e(9)]).then(n.t.bind(null,"rmP6",7))}),{ssr:!1,loadableGenerated:{webpack:function(){return["rmP6"]},modules:["react-quill"]}});t.a=Object(o.withRouter)((function(e){var t,n=e.router,l=Object(c.useState)(""),o=l[0],u=l[1],i=Object(c.useState)([]),g=i[0],j=i[1],N=Object(c.useState)([]),w=N[0],x=N[1],_=Object(c.useState)([]),P=_[0],k=_[1],E=Object(c.useState)([]),S=E[0],D=E[1],q=Object(c.useState)((t={title:"",error:"",success:"",formData:""},Object(a.a)(t,"title",""),Object(a.a)(t,"body",""),t)),R=q[0],Y=q[1],C=R.error,F=R.success,B=R.formData,H=R.title,I=Object(m.c)("token");Object(c.useEffect)((function(){Y(v(v({},R),{},{formData:new FormData})),M(),z(),G()}),[n]);var M=function(){n.query.slug&&Object(d.g)(n.query.slug).then((function(e){e.error?console.log(e.error):(Y(v(v({},R),{},{title:e.title})),u(e.body),T(e.categories),U(e.tags))}))},T=function(e){var t=[];e.map((function(e,n){t.push(e._id)})),k(t)},U=function(e){var t=[];e.map((function(e,n){t.push(e._id)})),D(t)},z=function(){Object(f.b)().then((function(e){e.error?Y(v(v({},R),{},{error:e.error})):j(e)}))},G=function(){Object(b.b)().then((function(e){e.error?Y(v(v({},R),{},{error:e.error})):x(e)}))},A=function(e){return function(){Y(v(v({},R),{},{error:""}));var t=P.indexOf(e),n=Object(r.a)(P);-1===t?n.push(e):n.splice(t,1),console.log(n),k(n),B.set("categories",n)}},J=function(e){return function(){Y(v(v({},R),{},{error:""}));var t=S.indexOf(e),n=Object(r.a)(S);-1===t?n.push(e):n.splice(t,1),console.log(n),D(n),B.set("tags",n)}},L=function(e){return-1!==P.indexOf(e)},X=function(e){return-1!==S.indexOf(e)},K=function(e){return function(t){var n,r="photo"===e?t.target.files[0]:t.target.value;B.set(e,r),Y(v(v({},R),{},(n={},Object(a.a)(n,e,r),Object(a.a)(n,"formData",B),Object(a.a)(n,"error",""),n)))}},Q=function(e){u(e),B.set("body",e)};return h("div",{className:"container-fluid pb-5"},h("div",{className:"row"},h("div",{className:"col-md-8"},h("form",{onSubmit:function(e){e.preventDefault(),Object(d.h)(B,I,n.query.slug).then((function(e){e.error?Y(v(v({},R),{},{error:e.error})):(Y(v(v({},R),{},{title:"",success:'Blog titled "'.concat(e.title,'" is successfully updated')})),Object(m.e)()&&1===Object(m.e)().role?s.a.replace("/admin"):Object(m.e)()&&0===Object(m.e)().role&&s.a.replace("/user"))}))}},h("div",{className:"form-group"},h("label",{className:"text-muted"},"Title"),h("input",{type:"text",className:"form-control",value:H,onChange:K("title")})),h("div",{className:"form-group"},h(y,{modules:p.b,formats:p.a,value:o,placeholder:"Write something amazing...",onChange:Q})),h("div",null,h("button",{type:"submit",className:"btn btn-primary"},"Update"))),h("div",{className:"pt-3"},h("div",{className:"alert alert-success",style:{display:F?"":"none"}},F),h("div",{className:"alert alert-danger",style:{display:C?"":"none"}},C)),o&&h("img",{src:"".concat(O.a,"/blog/photo/").concat(n.query.slug),alt:H,style:{width:"100%"}})),h("div",{className:"col-md-4"},h("div",null,h("div",{className:"form-group pb-2"},h("h5",null,"Featured image"),h("hr",null),h("small",{className:"text-muted"},"Max size: 1mb"),h("br",null),h("label",{className:"btn btn-outline-info"},"Upload featured image",h("input",{onChange:K("photo"),type:"file",accept:"image/*",hidden:!0})))),h("div",null,h("h5",null,"Categories"),h("hr",null),h("ul",{style:{maxHeight:"200px",overflowY:"scroll"}},g&&g.map((function(e,t){return h("li",{key:t,className:"list-unstyled"},h("input",{onChange:A(e._id),checked:L(e._id),type:"checkbox",className:"mr-2"}),h("label",{className:"form-check-label"},e.name))})))),h("div",null,h("h5",null,"Tags"),h("hr",null),h("ul",{style:{maxHeight:"200px",overflowY:"scroll"}},w&&w.map((function(e,t){return h("li",{key:t,className:"list-unstyled"},h("input",{onChange:J(e._id),checked:X(e._id),type:"checkbox",className:"mr-2"}),h("label",{className:"form-check-label"},e.name))})))))))}))},SmLR:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/user/crud/[slug]",function(){return n("0iGR")}])},yxxe:function(e,t,n){"use strict";var r=n("q1tI"),a=n.n(r),c=n("nOHt"),l=n.n(c),o=n("iuBY"),s=a.a.createElement;t.a=function(e){var t=e.children;return Object(r.useEffect)((function(){Object(o.e)()||l.a.push("/signin")}),[]),s(a.a.Fragment,null,t)}}},[["SmLR",1,0,2,3,7,6]]]);